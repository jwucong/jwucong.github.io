!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.JwcProgress=e():t.JwcProgress=e()}("undefined"!=typeof self?self:this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function r(t){"function"==typeof t&&t.apply(this,[].slice.call(arguments,1))}function i(t,e){return Math.round(Math.random()*(e-t)+t)}function o(t,e,n){return t<e?e:t>n?n:t}function l(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function s(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)}function u(t){return"Function"===s(t)}function a(t){return(e=/^HTML(\w+)Element$/.exec(s(t)))&&"Unknown"!==e[1]?t:function(t){return"String"===s(t)}(t)?document.querySelector(t):document.body;var e}function c(t,e,n){var r=[].concat(t),i=document.createElement("div");return i.className=r.join(" "),"Object"===s(e)&&function(t,e){var n=[];for(var r in e)l(e,r)&&n.push(r.replace(/[A-Z]/g,(function(t,e){return(e>0?"-"+t:t).toLowerCase()}))+":"+e[r]);t.style.cssText=n.join(";")}(i,e),n&&(i.innerHTML=n),i}function f(t){return"function"==typeof window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function d(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=0,n=null,i=null,o=!1,l=[window.requestAnimationFrame,window.webkitRequestAnimationFrame,window.mozRequestAnimationFrame,window.oRequestAnimationFrame,window.msRequestAnimationFrame].filter(Boolean)[0]||function(t){return setTimeout((function(){r(t,Date.now())}),1e3/60)},s=function(){f(i),o=!0};return function(u,a,c){o=!1,i=l((function d(p){n||(n=p);var h=p-n,v={current:p,previous:e,start:n,delta:h,durationEnd:h>=u};if(t&&v.durationEnd)return f(i),r(c,v,s);r(a,v,s),o||(e=p,i=l(d))}))}}function p(t){var e=t.reduce((function(t,e){return t[e.key]={value:e.value,writable:!1,enumerable:!0,configurable:!1},t}),{});Object.defineProperties(this,e)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t){var e=null,n=this,i=(n.options.template+"").trim(),o=i&&!/^\<[a-z]+.+\>$/i.test(this.template),l=function(){return a(n.options.container)},s=function(){return document.querySelector(i)},u=function(){return o?s()&&l():l()},c=function(){e&&clearInterval(e);var u=o?s().outerHTML:i;r.call(n,t,l(),u)};if(u())return c();document.addEventListener("DOMContentLoaded",c,!1),e=setInterval((function(){u()&&(document.removeEventListener("DOMContentLoaded",c,!1),c())}),5)}n.r(e);var y,m={template:"",container:null,containerStyle:null,customClass:"",classPrefix:"jwc",inlineStyle:!0,duration:1500,timeout:0,slowRange:"85-96",stopAt:99,onInited:null,onStart:null,onProgress:null,onEnd:null,onTimeout:null},g=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),p.call(this,[{key:"name",value:"jwcProgress"},{key:"version",value:"1.0.0"}]),this.options=Object.assign({},m,e||{}),this.$el=null,this.$lineNode=null,this.$textNode=null,this.$tempNode=null,this.template=null,this.container=null,this.waker=null,this.queue=[],this.progress=0,this.running=!1,this.ended=!1,this.ready=!1,this.init(),v.call(this,(function(t,e){var n=this;this.ready=!0,this.container=t,this.template=e,this.queue.forEach((function(t){return t.api.apply(n,t.args)}),this),this.queue=[]}))}var e,n,l;return e=t,(n=[{key:"init",value:function(){var t=this;if(this.$el)return this;var e=this.options,n=e.customClass,i=function(i){var o,l,s;return n&&!i.classList.contains(n)&&i.classList.add(n),t.$el=i,o=i,l=t.container,(s=l.firstChild)?l.insertBefore(o,s):l.appendChild(o),r.call(t,e.onInited),t};if(this.$tempNode)return i(this.$tempNode);if(this.template){var o=/^\<[a-z]+.+\>$/i.test(this.template),l=document.createElement("div");return l.innerHTML=this.template,i(o?l.firstElementChild:l)}var s=function(t){return[].concat(t).map((function(t){return e.classPrefix+"-"+t}))},u=function(t){return e.inlineStyle?t:null},a=Object.assign({position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:999,backgroundColor:"#fff"},e.containerStyle),f=c(s("progress-container"),u(a)),d=c(s("progressbar-full"),u({position:"absolute",top:"50%",left:0,width:"100%",height:"1px",overflow:"hidden"})),p=c(s("progressbar-now"),u({position:"absolute",top:0,left:0,width:"100%",height:0,borderTop:"1px solid #000",transform:"scaleY(0.5) translateX(-100%)"})),h=c(s("progress-val"),u({position:"absolute",bottom:"35px",left:0,width:"100%",textAlign:"center",fontSize:"12px",color:"#999"}),"0%");return d.appendChild(p),f.appendChild(d),f.appendChild(h),this.$lineNode=p,this.$textNode=h,i(f)}},{key:"setProgress",value:function(t){var e=o(t,0,100),n=parseInt(this.progress,10),i=parseInt(e,10);if(this.$lineNode){var l=e-100;this.$lineNode.style.transform="scaleY(0.5) translateX(".concat(l,"%)")}this.$textNode&&i-n>=1&&(this.$textNode.innerText=i+" %"),this.progress=e,r.call(this,this.options.onProgress,e)}},{key:"start",value:function(t){if(this.running)return this;var e=this,n=this.options,l=parseFloat(n.stopAt)||99,s=n.slowRange.split("-"),u=Math.min.apply(null,s),a=Math.max.apply(null,s),c=parseInt(t||n.duration,10)||1200,f=o(u,70,l),p=o(a,f,l),h=i(5,20),v=i(f,p),y=i(24,30)/10,m=Math.floor(h*y/100*c),g=c-m,w=parseInt(n.timeout,10),b=null,$=Date.now(),x=function(t,i){if(w&&Date.now()-$>=w)return i(),clearInterval(b),void r.call(e,n.onTimeout);var o=e.progress;if(!e.ended&&o>=v)i(),b=setInterval((function(){return o>=l?clearInterval(b):w&&Date.now()-$>=w?(clearInterval(b),void r.call(e,n.onTimeout)):(o+=.028,void e.setProgress(o))}),200);else{e.ended&&clearInterval(b);var s=t.current-t.start==0,u=t.current-t.previous;o<h?o=(o+=h/m*(s?17:u))>h?h:o:o<v?o=(o+=v/g*(s?17:u))>v?v:o:o+=e.ended?1.5:h/m*(s?17:u),e.setProgress(o),e.progress>=100&&(i(),e.running=!1,e.waker=null,r.call(e,n.onEnd))}},k=d(!1);return this.waker=function(){this.running=!0,k(c,x)},this.waker(),r.call(e,n.onStart),this}},{key:"end",value:function(){return this.ended=!0,r.call(this,this.waker),this.waker=null,this}},{key:"show",value:function(){return this.$el?(this.$el.style.opacity=1,this.$el.style.display="block",this):this}},{key:"hide",value:function(){return this.$el?(this.$el.style.opacity=0,this.$el.style.display="none",this):this}},{key:"fadeIn",value:function(t,e){u(t)&&(e=t,t=void 0);var n=this.$el;if(!n||"none"!==n.style.display)return this;var i=function(t){n.style.opacity=o(t,0,1)};i(0),n.style.display="block";var l=this,s=parseInt(t,10)||750,a=0;return d()(s,(function(t){var e=t.current-t.start==0,n=t.current-t.previous;i(a+=1/s*(e?17:n))}),(function(){a<1&&i(1),r.call(l,e)})),this}},{key:"fadeOut",value:function(t,e){u(t)&&(e=t,t=void 0);var n=this.$el;if(!n||"none"===n.style.display)return this;var i=function(t){n.style.opacity=o(t,0,1)};i(1),n.style.display="block";var l=this,s=parseInt(t,10)||750,a=1;return d()(s,(function(t){var e=t.current-t.start==0,n=t.current-t.previous;i(a-=1/s*(e?17:n))}),(function(){a>0&&i(0),n.style.display="none",r.call(l,e)})),this}},{key:"destroy",value:function(){return this.$el&&this.$el.parentNode.removeChild(this.$el),this.$el=null,this.$lineNode=null,this.$textNode=null,this.progress=0,this.ended=!1,this.running=!1,this.waker=null,this.queue=[],this}}])&&h(e.prototype,n),l&&h(e,l),t}();y=g.prototype,Object.getOwnPropertyNames(y).filter((function(t){return"constructor"!==t})).forEach((function(t){l(y,t)&&u(y[t])&&(y[t]=function(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.ready?t.apply(this,n):(this.queue.push({api:t,args:n}),this)}}(y[t]))}));e.default=g}]).default}));
//# sourceMappingURL=jwcProgress.js.map